==== Running pruning attacks ====
Running pruning with 10% sparsity...
Loading network from "/home/mzoughebi/personal_study/stylegan2-ada-pytorch_VF/training-runs-uchi_test/00000-CelebA_adapted_128-watermarking1-resumecustom/network-snapshot-000006.pkl"...
Watermarking dictionary found in the network pickle, will use it for watermark extraction metrics.
Dataset options:
{
  "class_name": "training.dataset.ImageFolderDataset",
  "path": "./dataset/CelebA_adapted_128.zip",
  "use_labels": false,
  "max_size": 160000,
  "xflip": false,
  "resolution": 128
}
Launching processes...
Setting up PyTorch plugin "bias_act_plugin"... Done.
Setting up PyTorch plugin "upfirdn2d_plugin"... Done.

Generator             Parameters  Buffers  Output shape        Datatype
---                   ---         ---      ---                 ---     
mapping.fc0           262656      -        [1, 512]            float32 
mapping.fc1           262656      -        [1, 512]            float32 
mapping               -           512      [1, 12, 512]        float32 
synthesis.b4.conv1    2622465     32       [1, 512, 4, 4]      float32 
synthesis.b4.torgb    264195      -        [1, 3, 4, 4]        float32 
synthesis.b4:0        8192        16       [1, 512, 4, 4]      float32 
synthesis.b4:1        -           -        [1, 512, 4, 4]      float32 
synthesis.b8.conv0    2622465     80       [1, 512, 8, 8]      float32 
synthesis.b8.conv1    2622465     80       [1, 512, 8, 8]      float32 
synthesis.b8.torgb    264195      -        [1, 3, 8, 8]        float32 
synthesis.b8:0        -           16       [1, 512, 8, 8]      float32 
synthesis.b8:1        -           -        [1, 512, 8, 8]      float32 
synthesis.b16.conv0   2622465     272      [1, 512, 16, 16]    float16 
synthesis.b16.conv1   2622465     272      [1, 512, 16, 16]    float16 
synthesis.b16.torgb   264195      -        [1, 3, 16, 16]      float16 
synthesis.b16:0       -           16       [1, 512, 16, 16]    float16 
synthesis.b16:1       -           -        [1, 512, 16, 16]    float32 
synthesis.b32.conv0   2622465     1040     [1, 512, 32, 32]    float16 
synthesis.b32.conv1   2622465     1040     [1, 512, 32, 32]    float16 
synthesis.b32.torgb   264195      -        [1, 3, 32, 32]      float16 
synthesis.b32:0       -           16       [1, 512, 32, 32]    float16 
synthesis.b32:1       -           -        [1, 512, 32, 32]    float32 
synthesis.b64.conv0   1442561     4112     [1, 256, 64, 64]    float16 
synthesis.b64.conv1   721409      4112     [1, 256, 64, 64]    float16 
synthesis.b64.torgb   132099      -        [1, 3, 64, 64]      float16 
synthesis.b64:0       -           16       [1, 256, 64, 64]    float16 
synthesis.b64:1       -           -        [1, 256, 64, 64]    float32 
synthesis.b128.conv0  426369      16400    [1, 128, 128, 128]  float16 
synthesis.b128.conv1  213249      16400    [1, 128, 128, 128]  float16 
synthesis.b128.torgb  66051       -        [1, 3, 128, 128]    float16 
synthesis.b128:0      -           16       [1, 128, 128, 128]  float16 
synthesis.b128:1      -           -        [1, 128, 128, 128]  float32 
---                   ---         ---      ---                 ---     
Total                 22949277    44448    -                   -       

Calculating uchida_extraction...
Traceback (most recent call last):
  File "calc_metrics_after_network_attacks.py", line 250, in <module>
    calc_metrics() # pylint: disable=no-value-for-parameter
  File "/home/mzoughebi/miniconda3/envs/stylegan/lib/python3.7/site-packages/click/core.py", line 1128, in __call__
    return self.main(*args, **kwargs)
  File "/home/mzoughebi/miniconda3/envs/stylegan/lib/python3.7/site-packages/click/core.py", line 1053, in main
    rv = self.invoke(ctx)
  File "/home/mzoughebi/miniconda3/envs/stylegan/lib/python3.7/site-packages/click/core.py", line 1395, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/home/mzoughebi/miniconda3/envs/stylegan/lib/python3.7/site-packages/click/core.py", line 754, in invoke
    return __callback(*args, **kwargs)
  File "/home/mzoughebi/miniconda3/envs/stylegan/lib/python3.7/site-packages/click/decorators.py", line 26, in new_func
    return f(get_current_context(), *args, **kwargs)
  File "calc_metrics_after_network_attacks.py", line 243, in calc_metrics
    subprocess_fn(rank=0, args=args, temp_dir=temp_dir, attack_name=attack_name, attacks_parameters=attacks_parameters)
  File "calc_metrics_after_network_attacks.py", line 86, in subprocess_fn
    generate_samples(G, args, device, name='fakes_before_attack.png')
  File "calc_metrics_after_network_attacks.py", line 43, in generate_samples
    save_image_grid(images, os.path.join(args.run_dir, name), drange=[-1,1], grid_size=grid_size)
  File "/home/mzoughebi/miniconda3/envs/stylegan/lib/python3.7/posixpath.py", line 80, in join
    a = os.fspath(a)
TypeError: expected str, bytes or os.PathLike object, not NoneType
Running pruning with 40% sparsity...
Loading network from "/home/mzoughebi/personal_study/stylegan2-ada-pytorch_VF/training-runs-uchi_test/00000-CelebA_adapted_128-watermarking1-resumecustom/network-snapshot-000006.pkl"...
Watermarking dictionary found in the network pickle, will use it for watermark extraction metrics.
Dataset options:
{
  "class_name": "training.dataset.ImageFolderDataset",
  "path": "./dataset/CelebA_adapted_128.zip",
  "use_labels": false,
  "max_size": 160000,
  "xflip": false,
  "resolution": 128
}
Launching processes...
Setting up PyTorch plugin "bias_act_plugin"... Done.
Setting up PyTorch plugin "upfirdn2d_plugin"... Done.

Generator             Parameters  Buffers  Output shape        Datatype
---                   ---         ---      ---                 ---     
mapping.fc0           262656      -        [1, 512]            float32 
mapping.fc1           262656      -        [1, 512]            float32 
mapping               -           512      [1, 12, 512]        float32 
synthesis.b4.conv1    2622465     32       [1, 512, 4, 4]      float32 
synthesis.b4.torgb    264195      -        [1, 3, 4, 4]        float32 
synthesis.b4:0        8192        16       [1, 512, 4, 4]      float32 
synthesis.b4:1        -           -        [1, 512, 4, 4]      float32 
synthesis.b8.conv0    2622465     80       [1, 512, 8, 8]      float32 
synthesis.b8.conv1    2622465     80       [1, 512, 8, 8]      float32 
synthesis.b8.torgb    264195      -        [1, 3, 8, 8]        float32 
synthesis.b8:0        -           16       [1, 512, 8, 8]      float32 
synthesis.b8:1        -           -        [1, 512, 8, 8]      float32 
synthesis.b16.conv0   2622465     272      [1, 512, 16, 16]    float16 
synthesis.b16.conv1   2622465     272      [1, 512, 16, 16]    float16 
synthesis.b16.torgb   264195      -        [1, 3, 16, 16]      float16 
synthesis.b16:0       -           16       [1, 512, 16, 16]    float16 
synthesis.b16:1       -           -        [1, 512, 16, 16]    float32 
synthesis.b32.conv0   2622465     1040     [1, 512, 32, 32]    float16 
synthesis.b32.conv1   2622465     1040     [1, 512, 32, 32]    float16 
synthesis.b32.torgb   264195      -        [1, 3, 32, 32]      float16 
synthesis.b32:0       -           16       [1, 512, 32, 32]    float16 
synthesis.b32:1       -           -        [1, 512, 32, 32]    float32 
synthesis.b64.conv0   1442561     4112     [1, 256, 64, 64]    float16 
synthesis.b64.conv1   721409      4112     [1, 256, 64, 64]    float16 
synthesis.b64.torgb   132099      -        [1, 3, 64, 64]      float16 
synthesis.b64:0       -           16       [1, 256, 64, 64]    float16 
synthesis.b64:1       -           -        [1, 256, 64, 64]    float32 
synthesis.b128.conv0  426369      16400    [1, 128, 128, 128]  float16 
synthesis.b128.conv1  213249      16400    [1, 128, 128, 128]  float16 
synthesis.b128.torgb  66051       -        [1, 3, 128, 128]    float16 
synthesis.b128:0      -           16       [1, 128, 128, 128]  float16 
synthesis.b128:1      -           -        [1, 128, 128, 128]  float32 
---                   ---         ---      ---                 ---     
Total                 22949277    44448    -                   -       

Calculating uchida_extraction...
Traceback (most recent call last):
  File "calc_metrics_after_network_attacks.py", line 250, in <module>
    calc_metrics() # pylint: disable=no-value-for-parameter
  File "/home/mzoughebi/miniconda3/envs/stylegan/lib/python3.7/site-packages/click/core.py", line 1128, in __call__
    return self.main(*args, **kwargs)
  File "/home/mzoughebi/miniconda3/envs/stylegan/lib/python3.7/site-packages/click/core.py", line 1053, in main
    rv = self.invoke(ctx)
  File "/home/mzoughebi/miniconda3/envs/stylegan/lib/python3.7/site-packages/click/core.py", line 1395, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/home/mzoughebi/miniconda3/envs/stylegan/lib/python3.7/site-packages/click/core.py", line 754, in invoke
    return __callback(*args, **kwargs)
  File "/home/mzoughebi/miniconda3/envs/stylegan/lib/python3.7/site-packages/click/decorators.py", line 26, in new_func
    return f(get_current_context(), *args, **kwargs)
  File "calc_metrics_after_network_attacks.py", line 243, in calc_metrics
    subprocess_fn(rank=0, args=args, temp_dir=temp_dir, attack_name=attack_name, attacks_parameters=attacks_parameters)
  File "calc_metrics_after_network_attacks.py", line 86, in subprocess_fn
    generate_samples(G, args, device, name='fakes_before_attack.png')
  File "calc_metrics_after_network_attacks.py", line 43, in generate_samples
    save_image_grid(images, os.path.join(args.run_dir, name), drange=[-1,1], grid_size=grid_size)
  File "/home/mzoughebi/miniconda3/envs/stylegan/lib/python3.7/posixpath.py", line 80, in join
    a = os.fspath(a)
TypeError: expected str, bytes or os.PathLike object, not NoneType
Running pruning with 80% sparsity...
Running pruning with 90% sparsity...
Running pruning with 99% sparsity...
